<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Vue2入门笔记</title>
      <link href="/2022/11/13/notes/vue2/"/>
      <url>/2022/11/13/notes/vue2/</url>
      
        <content type="html"><![CDATA[<h1 id="Bilibili黑马程序员Vue2"><a href="#Bilibili黑马程序员Vue2" class="headerlink" title="Bilibili黑马程序员Vue2"></a><a href="https://www.bilibili.com/video/BV1zq4y1p7ga/?vd_source=43f3f41b9a99cfe3d5248db59a3897c7">Bilibili黑马程序员Vue2</a></h1><p>基于<a href="https://www.bilibili.com/video/BV1zq4y1p7ga/?vd_source=43f3f41b9a99cfe3d5248db59a3897c7">Bilibili黑马程序员Vue2+vue3</a>教程的学习笔记</p><h2 id="前端工程化"><a href="#前端工程化" class="headerlink" title="前端工程化"></a>前端工程化</h2><ul><li>模块化</li><li>组件化</li><li>规范化</li><li>自动化<br>比如开发时热部署</li></ul><p>前端工程化具体解决方案：<strong>webpack</strong>（还有其他的，但是这个较为流行）</p><h2 id="webpack"><a href="#webpack" class="headerlink" title="webpack"></a>webpack</h2><p>webpack是前端项目工程化的具体解决方案。</p><p>能够压缩代码、处理浏览器端JavaScript兼容性、性能优化。</p><h3 id="webpack的基本使用"><a href="#webpack的基本使用" class="headerlink" title="webpack的基本使用"></a>webpack的基本使用</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建node项目</span></span><br><span class="line">$ npm init -y</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在项目根目录中创建src源代码目录</span></span><br><span class="line">$ <span class="built_in">mkdir</span> src</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在src中创建index.html与index.js</span></span><br><span class="line">$ <span class="built_in">cd</span> src</span><br><span class="line">$ <span class="built_in">touch</span> index.html</span><br><span class="line">$ <span class="built_in">touch</span> index.js</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装JQuery</span></span><br><span class="line">$ npm install npm jquery --save</span><br><span class="line">$ npm install npm jquery -S</span><br></pre></td></tr></table></figure><p>使用ES6导入JQuery</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入jquery第三方包，并使用变量$接收</span></span><br><span class="line"><span class="keyword">import</span> $ <span class="keyword">from</span> <span class="string">&#x27;jquery&#x27;</span></span><br><span class="line"></span><br><span class="line">$(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 实现奇偶变色</span></span><br><span class="line">  $(<span class="string">&#x27;li:odd&#x27;</span>).<span class="title function_">css</span>(<span class="string">&#x27;background-color&#x27;</span>,<span class="string">&#x27;red&#x27;</span>);</span><br><span class="line">  $(<span class="string">&#x27;li:even&#x27;</span>).<span class="title function_">css</span>(<span class="string">&#x27;background-color&#x27;</span>,<span class="string">&#x27;pink&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>在index.html中导入包含以上代码的index.js文件后，会出现语法错误，因为浏览器不支持ES6语法。可以使用webpack来帮我们解决。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装webpack相关的两个包，--save-dev让包保存在devDependencies节点中</span></span><br><span class="line"><span class="comment"># --save-dev表示只在开发阶段使用到的包（4.7.2版本好像有问题，目前直接安装最新版本就能解决）</span></span><br><span class="line">$ npm install webpack@5.42.1 webpack-cli@4.7.2 --save-dev</span><br><span class="line">$ npm install webpack@5.42.1 webpack-cli@4.7.2 --D</span><br></pre></td></tr></table></figure><p>在项目根目录中，创建名为webpack.config.js的webpack配置文件，初始化内容：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 向外导出一个webpack配置对象</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;development&#x27;</span>  <span class="comment">// mode用来指定构建模式，development（开发） production（生产）</span></span><br><span class="line">  <span class="comment">// 使用development打包速度快，代码不会压缩，项目体积大</span></span><br><span class="line">  <span class="comment">// 使用production打包速度慢，代码会压缩，项目体积小</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在package.json的scripts阶段下，新增dev脚本（也可以叫其他的名字）</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  <span class="string">&quot;dev&quot;</span>: <span class="string">&quot;webpack&quot;</span> <span class="comment">// 使用npm run xxx执行对应脚本，如：npm run dev</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用<code>$ npm run dev</code>来使用webpack工具，它会先读取webpack.config.js这个文件，然后根据配置在项目根目录生成一个dist目标目录，其中有一个main.js脚本文件，并且这个main.js包含index.js与jquery.js的代码</p><p>然后再在index.html中引入main.js代码，就能够运行了，没有兼容性问题。</p><p>webpack4.x与5.x默认打包的入口文件为&#x2F;src&#x2F;index.js，默认输出文件的路径为&#x2F;dist&#x2F;main.js，可以在webpack.config.js配置文件中可以修改默认配置，通过entry节点可以指定导报的入口，通过output节点指定打包的出口。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">  <span class="attr">entry</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./src/index.js&#x27;</span>),</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">path</span>: path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;./dist&#x27;</span>),</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;bundle.js&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="webpack中的插件"><a href="#webpack中的插件" class="headerlink" title="webpack中的插件"></a>webpack中的插件</h3><p>可以拓展webpack的能力</p><h4 id="webpack-dev-server"><a href="#webpack-dev-server" class="headerlink" title="webpack-dev-server"></a>webpack-dev-server</h4><p>每当修改了源代码，就会对项目进行构建和打包</p><p>使用<code>$ npm install webpack-dev-server@3.11.2 --save-dev</code>安装</p><p>安装后需要对package.json &gt; script中的dev命令进行修改</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  <span class="string">&quot;dev&quot;</span>: <span class="string">&quot;webpack serve&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用<code>$ npm run dev</code>运行项目，会发现程序一直在监听而不会退出，一旦源码进行修改项目就会重新打包。<strong>每次重新部署生成的目标文件并不会放在物理磁盘上，而是在内存中，能够通过控制台提示的地址访问</strong></p><p>默认访问此插件提供的http服务地址，是访问项目根目录，为了能够打开地址能够直接访问index首页，可以将&#x2F;src&#x2F;index.html复制一份放在项目根目录中，这里就可以用<strong>web-webpack-plugin</strong>第三方插件来帮我们完成</p><p>使用<code>$ npm install html-webpack-plugin@5.3.2 -save-dev</code>安装此插件</p><p>在webpack.config.js配置文件中中配置html-webpack-plugin</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 得到构造函数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HtmlPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建HTML插件实例对象</span></span><br><span class="line"><span class="keyword">const</span> htmlPlugin = <span class="keyword">new</span> <span class="title class_">HtmlPlugin</span>(&#123;</span><br><span class="line">  <span class="attr">template</span>: <span class="string">&#x27;./src/index.html&#x27;</span>,   <span class="comment">// 指定源文件的存放路径</span></span><br><span class="line">  <span class="attr">filename</span>: <span class="string">&#x27;./index.html&#x27;</span>        <span class="comment">// 指定生成文件的存放路径</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">  <span class="attr">plugins</span>: [htmlPlugin]           <span class="comment">// 通过plugins节点，使htmlPlugin插件生效</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="web-webpack-plugin"><a href="#web-webpack-plugin" class="headerlink" title="web-webpack-plugin"></a>web-webpack-plugin</h4>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 学习 </tag>
            
            <tag> Vue入门 </tag>
            
            <tag> Vue2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NodeJS入门笔记</title>
      <link href="/2022/11/07/notes/nodejs/"/>
      <url>/2022/11/07/notes/nodejs/</url>
      
        <content type="html"><![CDATA[<h1 id="Bilibili黑马程序员NodeJS"><a href="#Bilibili黑马程序员NodeJS" class="headerlink" title="Bilibili黑马程序员NodeJS"></a><a href="https://www.bilibili.com/video/BV1a34y167AZ">Bilibili黑马程序员NodeJS</a></h1><p>基于<a href="https://www.bilibili.com/video/BV1a34y167AZ">Bilibili黑马程序员NodeJS教程</a>的学习记录</p><h2 id="什么是nodejs"><a href="#什么是nodejs" class="headerlink" title="什么是nodejs"></a>什么是nodejs</h2><p>nodejs是基于谷歌v8引擎的js解释器，nodejs包含npm，npm是node包管理工具</p><h2 id="如何运行js代码"><a href="#如何运行js代码" class="headerlink" title="如何运行js代码"></a>如何运行js代码</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 执行当前目录下名为xx.js的js源文件</span></span><br><span class="line">$ node xx.js</span><br></pre></td></tr></table></figure><h2 id="内置模块"><a href="#内置模块" class="headerlink" title="内置模块"></a>内置模块</h2><p>nodejs也和chrome的v8一样，有一些内置模块供我们使用</p><ul><li><p>fs文件模块</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入fs模块</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br></pre></td></tr></table></figure></li><li><p>path路径模块</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入path模块</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br></pre></td></tr></table></figure></li><li><p>http服务模块</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入http模块</span></span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br></pre></td></tr></table></figure></li></ul><h2 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1、标准</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 或者</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">xx</span> = xxx;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2、简洁</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">xx</span> = xxx;</span><br></pre></td></tr></table></figure><h2 id="npm使用"><a href="#npm使用" class="headerlink" title="npm使用"></a>npm使用</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 因为npm默认下载包的地址在国外，可以切换国内的镜像源</span></span><br><span class="line"><span class="comment"># 下载镜像源快速切换工具nrm</span></span><br><span class="line">$ npm install -g nrm</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看镜像源列表</span></span><br><span class="line">$ nrm <span class="built_in">ls</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用列表中的镜像，例：</span></span><br><span class="line">$ nrm use taobao</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下载某个包</span></span><br><span class="line">$ npm install xxxx[@version] [--save]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 卸载某个包</span></span><br><span class="line">$ npm uninstall xxxx[@version] [--save]</span><br></pre></td></tr></table></figure><h2 id="express"><a href="#express" class="headerlink" title="express"></a>express</h2><p>优秀的第三方模块，能够快速开发中间件</p><h3 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 文件1</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Router</span> = express.<span class="title class_">Router</span>();</span><br><span class="line"><span class="title class_">Router</span>.<span class="title function_">get</span>(<span class="string">&#x27;path1&#x27;</span>,func1);</span><br><span class="line"><span class="title class_">Router</span>.<span class="title function_">post</span>(<span class="string">&#x27;path2&#x27;</span>,func2);</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title class_">Router</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 文件2</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Router</span> = <span class="built_in">require</span>(<span class="string">&#x27;./文件1&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;前缀&#x27;</span>,<span class="title class_">Router</span>);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(端口,funciton;</span><br></pre></td></tr></table></figure><h3 id="中间件"><a href="#中间件" class="headerlink" title="中间件"></a>中间件</h3><p>express在收到请求时会先调用中间件</p><p>中间件的调用会根据中间件注册的顺序执行，而且会共用一个res和req，也就是说可以在上游中间件给res对象和req对象加入一些属性或方法供下游中间件使用。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建中间件</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">mw1</span>(<span class="params">req,res,next</span>) &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    你的代码</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"><span class="title function_">next</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">mw2</span>(<span class="params">req,res,next</span>) &#123;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">你的代码</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title function_">next</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册全局生效中间件</span></span><br><span class="line">app.<span class="title function_">use</span>(mw1);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册局部生效的中间件</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;path&#x27;</span>,mw2,func);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册多个局部生效的中间件</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;path&#x27;</span>,[mw1,mw2],func);</span><br><span class="line"><span class="comment">// or</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;path&#x27;</span>,mw1,mw2,func);</span><br></pre></td></tr></table></figure><p><strong>注意事项</strong></p><ul><li>中间件的注册应当放在路由的前面</li><li>中间件函数中的业务完成后应当调用next函数，否则请求会停止在此中间件</li><li>中间件函数应当最后调用next函数，不能在next函数调用后还继续写代码，否则会造成代码混乱</li></ul><h3 id="中间件的分类"><a href="#中间件的分类" class="headerlink" title="中间件的分类"></a>中间件的分类</h3><ul><li><p>应用级别中间件<br>注册在app上的中间件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">mw</span> = (<span class="params">req,res,next</span>) =&gt; &#123;</span><br><span class="line"><span class="title function_">next</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 直接注册在app上</span></span><br><span class="line">app.<span class="title function_">use</span>(mw);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册在app的路由上</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;path&#x27;</span>,mw,func);</span><br></pre></td></tr></table></figure></li><li><p>路由级别中间件</p></li></ul><p>注册在Router上的中间件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Router</span> = express.<span class="title class_">Router</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">mw</span> = (<span class="params">req,res,next</span>) =&gt; &#123;</span><br><span class="line"><span class="title function_">next</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Router</span>.<span class="title function_">use</span>(mw);</span><br></pre></td></tr></table></figure><ul><li>错误级别中间件</li></ul><p>用于处理错误，防止系统崩溃的中间件，一定要在路由后注册</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义错误中间件，相较于普通中间件多了一个err参数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">mw</span> = (<span class="params">err,req,res,next</span>) =&gt; &#123;</span><br><span class="line"><span class="title function_">next</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;path&#x27;</span>,func);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在路由后注册才会有err对象，否则err为undefined</span></span><br><span class="line">app.<span class="title function_">use</span>(mw);</span><br></pre></td></tr></table></figure><ul><li>内置中间件</li></ul><p>express自带的中间件</p><ul><li>内置中间件-express.static()</li></ul><p>快速托管静态资源</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;prefix&#x27;</span>,express.<span class="title function_">static</span>(<span class="string">&#x27;path&#x27;</span>));</span><br></pre></td></tr></table></figure><ul><li>内置中间件-express.json()</li></ul><p>解析请求体中的json数据</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过req对象的body属性获取</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;path&#x27;</span>,<span class="function">(<span class="params">req,res</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">let</span> body = req.<span class="property">body</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(body);</span><br><span class="line">res.<span class="title function_">send</span>(body);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li>内置中间件-express.urlencoded()</li></ul><p>解析请求体中url-www-extended（好像叫这个吧，忘了）的数据</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 传入一个对象（我也不太清楚什么意思）</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123;</span><br><span class="line"><span class="attr">extended</span>: <span class="literal">false</span>;</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过req对象的body属性获取</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;path&#x27;</span>,<span class="function">(<span class="params">req,res</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">let</span> body = req.<span class="property">body</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(body);</span><br><span class="line">res.<span class="title function_">send</span>(body);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li>第三方中间件</li></ul><p>别人写的优秀的第三方中间件，例如body-parser，但是<a href="mailto:&#101;&#x78;&#x70;&#114;&#101;&#x73;&#x73;&#x40;&#52;&#46;&#49;&#54;&#46;&#x30;">&#101;&#x78;&#x70;&#114;&#101;&#x73;&#x73;&#x40;&#52;&#46;&#49;&#54;&#46;&#x30;</a>以后就自带了这个东西<br>就是express.urlencoded()，它是基于body-parser的封装<br>首先要下载body-parser包</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install body-parser --save</span><br></pre></td></tr></table></figure><p>使用方法与express.encoded()差不多</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 传入一个对象（我也不太清楚什么意思）</span></span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123;</span><br><span class="line"><span class="attr">extended</span>: <span class="literal">false</span>;</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过req对象的body属性获取</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;path&#x27;</span>,<span class="function">(<span class="params">req,res</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">let</span> body = req.<span class="property">body</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(body);</span><br><span class="line">res.<span class="title function_">send</span>(body);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="跨域问题"><a href="#跨域问题" class="headerlink" title="跨域问题"></a>跨域问题</h2><p><strong>什么是跨域问题</strong></p><p>在浏览器控制台中会出现类似以下的报错</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Access to XMLHttpRequest at &#x27;http://127.0.0.1/api/get?id=2206831544&amp;name=%E9%A9%AC%E6%9F%90&amp;gender=%E7%94%B7&#x27; from origin &#x27;null&#x27; has been blocked by CORS policy: No &#x27;Access-Control-Allow-Origin&#x27; header is present on the requested resource.</span><br></pre></td></tr></table></figure><p>协议、域名、端口号的不同导致的跨域问题</p><p><strong>解决方案</strong></p><p>CORS（主流的解决方案，推荐使用）<br>JSONP（有缺陷的解决方案，只支持get请求）</p><h3 id="使用cors第三方中间件"><a href="#使用cors第三方中间件" class="headerlink" title="使用cors第三方中间件"></a>使用cors第三方中间件</h3><p>cors是express解决跨域问题的第三方中间件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载cors第三方包</span></span><br><span class="line">$ npm install cors --save</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&#x27;cors&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在引入路由之前注册cors中间件</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在此写入路由</span></span><br></pre></td></tr></table></figure><p><strong>指定域名通过跨域请求</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 指定http://19maken.top才能跨域访问</span></span><br><span class="line">res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>,<span class="string">&#x27;http://19maken.top&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 指定所有域名都能跨域访问</span></span><br><span class="line">res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>,<span class="string">&#x27;*&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 指定请求允许的请求方法</span></span><br><span class="line">res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Methods&#x27;</span>,<span class="string">&#x27;POST,GET,DELETE,HEAD&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 指定允许所有的请求</span></span><br><span class="line">res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Methods&#x27;</span>,<span class="string">&#x27;*&#x27;</span>);</span><br></pre></td></tr></table></figure><p>预检请求<br>有些请求不是简单请求，会先发送OPTION请求进行预检</p><p><strong>jsonp</strong></p><p>这个东西我也不太清楚，说是要如果配置了cors，就要配置在cors的前面，然后前端会使用script标签来解析响应的内容。</p><h2 id="mysql模块"><a href="#mysql模块" class="headerlink" title="mysql模块"></a>mysql模块</h2><p>这也是第三方模块，用于数据库的连接与操作。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载第三方包</span></span><br><span class="line">$ npm install mysql</span><br></pre></td></tr></table></figure><p>导入mysql模块并使用</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入mysql第三方包</span></span><br><span class="line"><span class="keyword">const</span> mysql = <span class="built_in">require</span>(<span class="string">&#x27;mysql&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建连接</span></span><br><span class="line"><span class="keyword">const</span> connection = mysql.<span class="title function_">createConnection</span>(&#123;</span><br><span class="line"><span class="attr">host</span>: <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line"><span class="attr">user</span>: <span class="string">&#x27;user&#x27;</span>,</span><br><span class="line"><span class="attr">password</span>: <span class="string">&#x27;secret&#x27;</span>,</span><br><span class="line"><span class="attr">database</span>: <span class="string">&#x27;database&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 连接</span></span><br><span class="line">connection.<span class="title function_">connect</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 操作连接</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">&#x27;SELECT 1+1 AS solution&#x27;</span>;</span><br><span class="line">connection.<span class="title function_">query</span>(sql,<span class="keyword">function</span>(<span class="params">error,results,fields</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (error) <span class="keyword">throw</span> error;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;The solution is:&#x27;</span>, results[<span class="number">0</span>],solution);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 关闭连接</span></span><br><span class="line">connection.<span class="title function_">end</span>();</span><br></pre></td></tr></table></figure><p>使用带占位符的sql语句，PS：占位符使用?</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1、多个占位符，使用数据传数据</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">&#x27;SELECT * FROM table WHERE age &gt; ? and gender = ?&#x27;</span>;</span><br><span class="line">connection.<span class="title function_">query</span>(sql,[<span class="number">18</span>,<span class="string">&#x27;男&#x27;</span>],<span class="keyword">function</span>(<span class="params">error,results,fields</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (error) <span class="keyword">throw</span> error;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(results);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2、如果占位符太多，可以使用对象</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">&#x27;INSERT INTO table (fields) values (?)&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> data = &#123;</span><br><span class="line"><span class="attr">field1</span>: field1,</span><br><span class="line"><span class="attr">field2</span>: field2,</span><br><span class="line">...</span><br><span class="line">&#125;</span><br><span class="line">connection.<span class="title function_">query</span>(sql,data,<span class="keyword">function</span>(<span class="params">error,results,fields</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (error) <span class="keyword">throw</span> error;</span><br><span class="line"><span class="comment">// 查看受影响的行数</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(results.<span class="property">affectedRows</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3、如果只有一个占位符，那么就可以不用使用数组传数据，直接使用数据</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">&#x27;SELECT * FROM table WHERE age &gt; ?&#x27;</span>;</span><br><span class="line">connection.<span class="title function_">query</span>(sql,<span class="number">18</span>,<span class="keyword">function</span>(<span class="params">error,results,fields</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (error) <span class="keyword">throw</span> error;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(results);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><strong>注意事项</strong></p><p>在执行操作的时候，如果执行的语句是查询语句，那么results就是一个数组，如果执行的是一个更新语句或者是删除语句，那么results就是一个对象，其中results的affectedRows属性可以查看执行后的语句所影响的行数。</p><h2 id="Web开发模式"><a href="#Web开发模式" class="headerlink" title="Web开发模式"></a>Web开发模式</h2><p>SEO?</p><p>服务端渲染</p><p>对SEO友好，但对服务器压力过大</p><p>前后端分离</p><p>服务器压力小，不用渲染页面，前端注重页面，后端注重API，对SEO不友好，但能使用VUE等框架提供的服务</p><p>如何选择？</p><p>不同的场景使用不同的模式，例如管理系统不怎么需要SEO，就可以使用前后端分离。有些网站也采用首页使用服务端渲染，其他页面使用前后端分离。</p><p><strong>身份验证</strong></p><ul><li>服务端渲染推荐使用Session认证机制。</li></ul><p>使用Cookie，它是存储在用户浏览器中一段不超过4KB的字符串，由一个名称（name）、一个值（value）和其他几个用于控制Cookie有效期、安全性和使用范围的可选属性组成。每当发起请求，会将未过期的Cookie一同发送到对应域名的服务器。服务端可以通过响应头发送Cookie给客户端。但是Cookie不安全，因为谁都可以看，会很好仿造。所以使用Cookie+Session认证。<strong>因为Session中的数据是对应客户端的</strong>客户端只能访问属于自己的session数据，而不能访问别的客户端的session数据。</p><ul><li>前后端分离推荐使用JWT认证机制。</li></ul><h2 id="在Express中使用Session认证"><a href="#在Express中使用Session认证" class="headerlink" title="在Express中使用Session认证"></a>在Express中使用Session认证</h2><p>下载express-session中间件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install express-session</span><br></pre></td></tr></table></figure><p>注册express-session中间件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> session = <span class="built_in">require</span>(<span class="string">&#x27;express-session&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">session</span>(&#123;</span><br><span class="line"><span class="attr">secret</span>: <span class="string">&#x27;keyboard cat&#x27;</span>,<span class="comment">// secret属性的值可以为任意字符串</span></span><br><span class="line"><span class="attr">resave</span>: <span class="literal">false</span>,<span class="comment">// 固定写法</span></span><br><span class="line"><span class="attr">saveUninitialized</span>: <span class="literal">true</span><span class="comment">// 固定写法</span></span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/user/login&#x27;</span>,<span class="keyword">function</span>(<span class="params">req,res</span>) &#123;</span><br><span class="line"><span class="comment">// 往session中存储数据</span></span><br><span class="line">req.<span class="property">session</span>.<span class="property">xxx1</span> = xxx1;</span><br><span class="line">req.<span class="property">session</span>.<span class="property">xxx2</span> = xxx2;</span><br><span class="line">res.<span class="title function_">send</span>(<span class="string">&#x27;success&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/user/getXxx&#x27;</span>,<span class="keyword">function</span>(<span class="params">req,res</span>) &#123;</span><br><span class="line"><span class="comment">// 取session中的数据</span></span><br><span class="line">res.<span class="title function_">send</span>(req.<span class="property">session</span>.<span class="property">xxx1</span> + <span class="string">&#x27;\n&#x27;</span> + req.<span class="property">session</span>.<span class="property">xxx2</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/user/logout&#x27;</span>,<span class="keyword">function</span>(<span class="params">req,res</span>) &#123;</span><br><span class="line"><span class="comment">// 清空Session中的数据</span></span><br><span class="line">req.<span class="property">session</span>.<span class="title function_">destroy</span>();</span><br><span class="line">res.<span class="title function_">send</span>(<span class="string">&#x27;success&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="JWT跨域认证"><a href="#JWT跨域认证" class="headerlink" title="JWT跨域认证"></a>JWT跨域认证</h2><p>由于Cookie默认不支持跨域，如果使用Session+Cookie作为身份验证机制，配置会很麻烦。JWT（JSON Web Token）是目前最流行的跨域认证解决方案。</p><p><strong>JWT工作流程</strong></p><p>首先客户端（浏览器）会发送登陆请求，服务器接收到请求后先验证账号和密码，验证通过后会将用户的信息对象经过加密后生成Token字符串（服务端不会存储这个字符串），然后响应给客户端，客户端收到响应后会将Token存放在浏览器的LocalStorage或者SessionStorage中，当客户端再次发送请求的时候会通过请求头的Authorization字段将Token发送给服务器，服务器验证这个Token是否合法，解析为之前打包所对应的数据，然后针对数据发送对应的响应。<strong>JWT中不要携带密码信息</strong></p><p>JWT组成部分，三部分，使用“.”分隔</p><p>Header(头部).Payload(有效荷载).Signature(签名)</p><p>Header与Signature只与安全有关，防止破解。Payload是加密后的用户信息。</p><p><strong>客户端如何使用JWT？</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 推荐做法：将JWT放在HTTP请求同的Authorization字段中。</span><br><span class="line">Authorization: Bearer &lt;token&gt;</span><br></pre></td></tr></table></figure><h2 id="在Express中使用JWT"><a href="#在Express中使用JWT" class="headerlink" title="在Express中使用JWT"></a>在Express中使用JWT</h2><p>安装JWT相关的包</p><p>jsonwebtoken 用于生成JWT字符串</p><p>express-jwt 用于将JWT字符串解析还原成JSON数据包</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装如下两个JWT相关的包</span></span><br><span class="line">$ npm install jsonwebtoken express-jwt</span><br></pre></td></tr></table></figure><p>定义secret密钥：用于JWT加密与解密，建议命名为secretKey</p><p>使用方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>);</span><br><span class="line"><span class="comment">// 新版使用方法(7.7.7)，expressJWT为接收变量名，可任意更换</span></span><br><span class="line"><span class="keyword">var</span> &#123;<span class="attr">expressjwt</span>: expressJWT&#125; = <span class="built_in">require</span>(<span class="string">&#x27;express-jwt&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义secret密钥（随意字符串）</span></span><br><span class="line"><span class="keyword">const</span> secretKey = <span class="string">&#x27;XXXX xxxx II&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置JWT解析中间件</span></span><br><span class="line"><span class="comment">// 这个algorithms必须配置，好像是配置加密算法</span></span><br><span class="line"><span class="comment">// expressJWT(&#123;&#125;)：配置解析</span></span><br><span class="line"><span class="comment">// expressJWT(&#123;&#125;).unless(&#123;&#125;)：配置哪些不使用解析</span></span><br><span class="line"><span class="comment">// 添加expressJWT中间件后，express会将解析的token信息挂载在req.user中</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">expressJWT</span>(&#123;</span><br><span class="line"><span class="attr">secret</span>: secretKey,</span><br><span class="line"><span class="attr">algorithms</span>: [<span class="string">&quot;HS256&quot;</span>]</span><br><span class="line">&#125;).<span class="title function_">unless</span>(&#123;</span><br><span class="line"><span class="attr">path</span>: [<span class="regexp">/^\/api\//</span>]</span><br><span class="line">&#125;));</span><br><span class="line"><span class="comment">// 解析请求体JSON数据</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/api/user/login/action&#x27;</span>,<span class="keyword">function</span>(<span class="params">req,res</span>) &#123;</span><br><span class="line"><span class="keyword">const</span> user = req.<span class="property">body</span>;</span><br><span class="line"><span class="keyword">if</span> (user.<span class="property">name</span> === <span class="string">&#x27;admin&#x27;</span> &amp;&amp; user.<span class="property">pwd</span> === <span class="string">&#x27;123456&#x27;</span>) &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;登陆成功！&#x27;</span>);</span><br><span class="line"><span class="comment">// 参数1：加密信息，必须为一个对象！</span></span><br><span class="line"><span class="comment">// 参数2：加密密钥</span></span><br><span class="line"><span class="comment">// 参数3：配置，有很多参数，这里只配置了token有效期为30秒</span></span><br><span class="line"><span class="keyword">const</span> tokenStr = jwt.<span class="title function_">sign</span>(&#123;<span class="attr">username</span>: user.<span class="property">name</span>&#125;,secretKey,&#123;<span class="attr">expiresIn</span>: <span class="string">&#x27;30s&#x27;</span>&#125;);</span><br><span class="line"></span><br><span class="line">res.<span class="title function_">send</span>(&#123;</span><br><span class="line"><span class="attr">status</span>: <span class="number">200</span>,</span><br><span class="line"><span class="attr">message</span>: <span class="string">&#x27;登陆成功！&#x27;</span>,</span><br><span class="line"><span class="attr">token</span>: tokenStr</span><br><span class="line">&#125;);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;登陆失败！&#x27;</span>);</span><br><span class="line">res.<span class="title function_">send</span>(&#123;</span><br><span class="line"><span class="attr">status</span>: <span class="number">200</span>,</span><br><span class="line"><span class="attr">message</span>: <span class="string">&#x27;登陆失败！&#x27;</span>,</span><br><span class="line"><span class="attr">token</span>: <span class="literal">null</span></span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 请求此接口时应该在请求头的Authorization中添加token信息</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/user/info&#x27;</span>,<span class="keyword">function</span>(<span class="params">req,res</span>) &#123;</span><br><span class="line"><span class="keyword">const</span> user = req.<span class="property">user</span>;</span><br><span class="line"><span class="comment">// username为之前生成token时需要打包的数据中的字段</span></span><br><span class="line"><span class="keyword">if</span> (user.<span class="property">username</span> === admin) &#123;</span><br><span class="line">res.<span class="title function_">send</span>(&#123;</span><br><span class="line"><span class="attr">code</span>: <span class="number">200</span>,</span><br><span class="line"><span class="attr">msg</span>: <span class="string">&#x27;请求成功！&#x27;</span>,</span><br><span class="line"><span class="attr">data</span>: &#123;</span><br><span class="line"><span class="attr">name</span>: <span class="string">&#x27;admin&#x27;</span>,</span><br><span class="line"><span class="attr">age</span>: <span class="number">19</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加token解析异常中间件处理</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">err,req,res,next</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (err.<span class="property">name</span> === <span class="string">&#x27;UnauthorizedError&#x27;</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> res.<span class="title function_">send</span>(&#123;</span><br><span class="line"><span class="attr">code</span>: <span class="number">401</span>,</span><br><span class="line"><span class="attr">msg</span>: <span class="string">&#x27;无效的token&#x27;</span>,</span><br><span class="line">&#125;);</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果不是token错误</span></span><br><span class="line">res.<span class="title function_">send</span>(&#123;</span><br><span class="line"><span class="attr">code</span>: <span class="number">500</span>,</span><br><span class="line"><span class="attr">msg</span>: <span class="string">&#x27;未知的错误&#x27;</span>,</span><br><span class="line">&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NodeJS入门 </tag>
            
            <tag> NodeJS </tag>
            
            <tag> 学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo建站感言</title>
      <link href="/2022/11/04/summary/hello-world/"/>
      <url>/2022/11/04/summary/hello-world/</url>
      
        <content type="html"><![CDATA[<h2 id="Hexo-建站感言"><a href="#Hexo-建站感言" class="headerlink" title="Hexo 建站感言"></a>Hexo 建站感言</h2><h3 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h3><p>历时三天，终于搞了一个基本能用的博客，非常激动！<br>其实之前我已经搭建过两三次博客了，但是都是照猫画虎，不知道为什么这样干，导致我最后无法维护我的博客，再加上搭建后就不想管了，之前的博客就逐渐被废弃了。虽然之前已经搭建过博客，但是本次重新搭建的期间还是遇到了很多的问题，只有疯狂百度，看别的博主发布的教程，最后还是都解决了，心累啊~</p><h3 id="为什么建设本站"><a href="#为什么建设本站" class="headerlink" title="为什么建设本站"></a>为什么建设本站</h3><p>首先就是因为周边的同学有，所以自己也想搞一个。而且写一些技术文章不仅能帮助别人，还能巩固知识，也可以在博客上分享一些趣事。<br>其实有很多的博客网站，例如CSDN和博客园之类的，但是它们的网站自由度不是很高，网站上不能挂自己想挂的东西，自己搭建的博客就有比较高的自由度了，可以按照自己喜欢的风格自定义。说不定这个以后还能帮助我拿到offer。</p><h3 id="对本站的打算"><a href="#对本站的打算" class="headerlink" title="对本站的打算"></a>对本站的打算</h3><p>前面也说到之前做过的博客网站都逐渐废弃了，但是这次想好好维护了，看到别人的博客网站有很多的文章，真的很羡慕啊，我也想要！之后打算把博客当备忘录用或者技术分享用，也就是记录一些编程学习过程中比较难记忆的内容，或者是自己踩过的坑，或者是一些个人感悟，抒发情绪之类的。目前的想法就是这样，以后可能会有改动，更新频率也不太确定，因为有时候很忙，有时候又没啥事儿，随缘更新。</p><h3 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h3><p>本博客使用<a href="https://hexo.io/zh-cn/">Hexo博客框架</a>+<a href="https://butterfly.js.org/">butterfly博客主题</a>+<a href="https://gitee.com/help/articles/4136">Gitee Pages服务</a>+<a href="https://www.aliyun.com/product/oss">aliyunOSS对象存储服务</a>构建，有前人栽树搭建起来真的很方便啊，特别感谢<a href="https://hexo.io/zh-cn/">Hexo</a>以及<a href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a>开源主题。<br>在此感谢我亲爱的室友<a href="https://gitee.com/jiaxinxiaobinggan">小马同学</a>画的背景图和头像，真的很好看呐。<br>也感谢正在看的你，因为有你才是我做此博客的目的。</p>]]></content>
      
      
      <categories>
          
          <category> 总结 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 个人博客 </tag>
            
            <tag> 聊一聊 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo博客管理</title>
      <link href="/2022/11/03/working/hexo-manage/"/>
      <url>/2022/11/03/working/hexo-manage/</url>
      
        <content type="html"><![CDATA[<h2 id="Hexo博客管理"><a href="#Hexo博客管理" class="headerlink" title="Hexo博客管理"></a>Hexo博客管理</h2><h3 id="创建一篇文章"><a href="#创建一篇文章" class="headerlink" title="创建一篇文章"></a>创建一篇文章</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;文章标题&quot;</span></span><br></pre></td></tr></table></figure><h3 id="清除上次生成的静态文件"><a href="#清除上次生成的静态文件" class="headerlink" title="清除上次生成的静态文件"></a>清除上次生成的静态文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo clean</span><br></pre></td></tr></table></figure><h3 id="生成静态文件"><a href="#生成静态文件" class="headerlink" title="生成静态文件"></a>生成静态文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><h3 id="开启本地web服务"><a href="#开启本地web服务" class="headerlink" title="开启本地web服务"></a>开启本地web服务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><h3 id="发布到远程静态文件托管平台"><a href="#发布到远程静态文件托管平台" class="headerlink" title="发布到远程静态文件托管平台"></a>发布到远程静态文件托管平台</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><h3 id="Gitee操作"><a href="#Gitee操作" class="headerlink" title="Gitee操作"></a>Gitee操作</h3><blockquote><p>本博客使用Gitee pages服务<br>发布后刷新静态文件仓库的pages服务</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 程序运行 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 个人博客 </tag>
            
            <tag> 命令 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
